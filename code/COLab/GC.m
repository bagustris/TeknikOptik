function Itot = GC(lambda,theta);% GC   Calculates the intensity distribution%    for a grating of many slits.  For use with%    Computational Optoelectronics Exercise 2. % -----------------------------------------------% Set up the optical and mathematical variables % -----------------------------------------------% All optical variables are global and set elsewhere  global slitWdth slitSepn numSlits;  % -------------------------------------------------% Calculate the grating intensity% -------------------------------------------------% First calculate beta and phi  beta = pi * slitWdth * sin(theta) / lambda;  phi  = pi * slitSepn * sin(theta) / lambda;% First calculate the diffraction pattern from a single slit  slitPatn = (sin(beta+eps)./(beta+eps)).^2;  % Then calculate the diffraction pattern from N point sources  srcePatn = (sin(numSlits*(phi+eps))./(numSlits*sin(phi+eps))).^2;% Choose an appropriate value for I(0)% Amplitude should be proportional to numSlits and slitWdth  I0 =  (numSlits*slitWdth)^2;  Itot = I0 * slitPatn .* srcePatn ;  return;