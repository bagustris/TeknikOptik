function [yd, Itot] = Huygens;% HUYGENS   Calculates the intensity %    distribution for one or two slits.  For use %    with Computational Optoelectronics, lab 1. % -----------------------------------------------% Set up the physical and mathematical variables % -----------------------------------------------% All physical variables are global and set elsewhere  global lambda scrnDist scrnWdth slitWdth slitSepn;% Numbers of sources and detectors can be changed easily  M = 51;   % Number of sources  N = 201;   % Number of detectors.% ------------------------------------------% Specify the source points% ------------------------------------------% The slit consists of M equivalent point sources% xs,ys are coordinates of the sources (row vectors)% All the sources lie along the y-axis (x=0)  xs  = zeros(1,M);   ys = [-slitWdth/2: slitWdth/(M-1): +slitWdth/2];  % The amplitudes of the field at the sources are equal   A  = 1;   % ------------------------------------------% Specify the detector points% ------------------------------------------% xd,yd are coordinates of the detectors (column vectors)% All the detectors lie along the line (y=scrnDist)  xd = scrnDist*ones(N,1);  yd = [-scrnWdth/2 : scrnWdth/(N-1) : +scrnWdth/2]'; % -------------------------------------------------% Calculate distances between sources and detectors% -------------------------------------------------% There are MxN values of (xd-xs) and (yd-ys).% Represent each by an MxN matrix.  Xdifferences = xd*ones(1,M) - ones(N,1)*xs;   Ydifferences = yd*ones(1,M) - ones(N,1)*ys;  % Calculate the MxN distances between detectors and sources  r = sqrt(Xdifferences.^2 + Ydifferences.^2);% -------------------------------------------------% Calculate fields between sources and detectors% -------------------------------------------------% Calculate the MxN fields at each detector arising % from each source, at times t=0 and t=T/4.  E0 = A*cos(2*pi*r/lambda)./r;  E4 = A*sin(2*pi*r/lambda)./r;% Calculate the total fields at each detector at times% t=0 and t=T/4.  There are N of these.  E0tot = sum(E0,2);  E4tot = sum(E4,2);% Intensity of the field at the N detectors  Itot = (E0tot.^2 + E4tot.^2)/2;return;